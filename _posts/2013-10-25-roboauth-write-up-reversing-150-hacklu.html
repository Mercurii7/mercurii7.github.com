---
layout: post
title: RoboAuth Write Up - Reversing 150 - Hack.lu 2013 CTF
date: '2013-10-25T11:21:00.000+08:00'
author: KE
tags:
- reversing
- Write Up
- Hack.lu 2013
modified_time: '2013-10-25T11:21:30.059+08:00'
thumbnail: http://1.bp.blogspot.com/-POk3gHwIwKc/UmjGJVaqy6I/AAAAAAAABGg/fjEqif_yg7U/s72-c/2013-10-24+15_02_25-D__CTF_hack.lu_RoboAuth.exe.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-8683271761943214839
blogger_orig_url: http://kectf.blogspot.com/2013/10/roboauth-write-up-reversing-150-hacklu.html
---

<blockquote class="tr_bq">Oh boy, those crazy robots can't catch a break! Now they're even stealing our liquid gold from one of our beer tents! And on top of that they lock it behind some authentication system. Quick! Access it before they consume all of our precious beverage!<br />Download: https://ctf.fluxfingers.net/static/downloads/roboauth/RoboAuth.exe<br />Flag: password1_password2</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-POk3gHwIwKc/UmjGJVaqy6I/AAAAAAAABGg/fjEqif_yg7U/s1600/2013-10-24+15_02_25-D__CTF_hack.lu_RoboAuth.exe.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="RoboAuth" border="0" height="136" src="http://1.bp.blogspot.com/-POk3gHwIwKc/UmjGJVaqy6I/AAAAAAAABGg/fjEqif_yg7U/s320/2013-10-24+15_02_25-D__CTF_hack.lu_RoboAuth.exe.png" title="RoboAuth" width="320" /></a></div>We are given an exe to reverse and find 2 passwords. The first password was easy enough to find in Ollydbg, just place a breakpoint at address 00401B6C, which is the strcmp function that checks if the password we provided is correct. Run the program, it will stop at the breakpoint and we can clearly see the correct password in the stack:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-xv7jpQrO-og/UmjHpmnbB_I/AAAAAAAABGo/km1cxvcLHFU/s1600/2013-10-24+15_08_39-.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="strcmp breakpoint" border="0" height="163" src="http://4.bp.blogspot.com/-xv7jpQrO-og/UmjHpmnbB_I/AAAAAAAABGo/km1cxvcLHFU/s400/2013-10-24+15_08_39-.png" title="strcmp" width="400" /></a></div>The second password is a bit more tricky. Ollydbg treats the second password checking function as data instead of commands. So we have to tell Olly to treat it as code instead of data. In Olly, select the lines from the address 0040157F to 004015E8, right click and select&nbsp;“Analysis”-&gt;”During next analysis, treat selection as”-&gt;”Commands”. This will show us the code for the function that checks the second password.<br /><br />There is an INT3 command at&nbsp;0040161F that stops the debugging process if the program is open in a debugger. We can tell Olly to ignore it by going to Options-&gt;Debugging Options-&gt;Exceptions and tick the box next to INT3 breaks.<br /><br />To summarise the function, it will take each character from a fixed string in the stack, XOR it with 2 and compare it with each character we input. We could place a breakpoint at 0040155B where it compares each character. We just need to input a string as long in length as the correct second password so that the check would go through all the characters and we just have to write them down.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-pefz6rUm2VA/UmjMH9QuXDI/AAAAAAAABGw/QkVzs4hS95s/s1600/2013-10-24+15_28_04-.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="Comparison of input and correct character" border="0" height="173" src="http://1.bp.blogspot.com/-pefz6rUm2VA/UmjMH9QuXDI/AAAAAAAABGw/QkVzs4hS95s/s320/2013-10-24+15_28_04-.png" title="Second Password" width="320" /></a></div>I just spammed 'a's as the second password and we can see the comparison function showing us the first correct character, 'w'. Of course, we could also trace the location in the stack where the function gets the correct second password and XOR each character ourselves.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-4k69OkRItD4/UmjMtT8RGvI/AAAAAAAABG4/5hhYFe-HJIU/s1600/2013-10-24+15_30_22-.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img alt="Second password before XOR" border="0" src="http://2.bp.blogspot.com/-4k69OkRItD4/UmjMtT8RGvI/AAAAAAAABG4/5hhYFe-HJIU/s1600/2013-10-24+15_30_22-.png" title="Second password before XOR" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Bytes in stack are in Little Endian</td></tr></tbody></table>So take 75 31 6E 6E 66 32 6C 67, XOR each character with 2 and we get:&nbsp;<span style="background-color: white; color: #393939; font-family: 'Helvetica Neue', Arial, Helvetica, sans-serif; font-size: 14px; line-height: 18px;">w3lld0ne </span>in ascii.<br /><br />Flag: r0b0RUlez!_w3lld0ne<br /><br /><br />