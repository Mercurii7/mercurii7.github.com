---
layout: post
title: 'InfoSec Institute CTF #2: Level 1'
date: '2015-07-22T13:26:00.000+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-25T00:35:42.082+08:00'
thumbnail: http://2.bp.blogspot.com/--POMzm3mqZw/Va8cDYnF2lI/AAAAAAAAGMQ/7fdfSEGD45Y/s72-c/test.jpg
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-7466810591466103908
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-1.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_7" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Our goal for this level is to add an&nbsp;<a href="http://www.w3schools.com/jsref/met_win_alert.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">alert script</a>&nbsp;with the message ‘Ex1’.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/--POMzm3mqZw/Va8cDYnF2lI/AAAAAAAAGMQ/7fdfSEGD45Y/s1600/test.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/--POMzm3mqZw/Va8cDYnF2lI/AAAAAAAAGMQ/7fdfSEGD45Y/s1600/test.jpg" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We can store links on the page by entering the site name and URL we wish to store. However, there are front-end input validations in place on both the ‘Site Name’ and ‘Site URL’ text box.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">I will be using the developer tools in Google Chrome to remove both input validations. You should be able to do the same with the developer tools in any modern browser.</div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_16" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">There are 2 input validation sources for this page, HTML5 validation and validation in the JavaScript sources. Let’s start with the HTML5 validation.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Right click on the ‘Site Name’ text box and click on Inspect element. The developer tools should pop up with the input element highlighted.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-n7CfxP4Npwc/Va6YLox1M3I/AAAAAAAAGL8/Db6ogCV1Jdc/s1600/developer-tools.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-n7CfxP4Npwc/Va6YLox1M3I/AAAAAAAAGL8/Db6ogCV1Jdc/s1600/developer-tools.png" /></a></div></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">The input restrictions applied to the text box is the ‘<a href="http://www.w3schools.com/tags/att_input_pattern.asp" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: 0px 0px; background-repeat: initial; background-size: initial; box-sizing: border-box; color: #a0aabf; cursor: pointer;">pattern</a>’ attribute. The ‘maxsize’ attribute is not a valid&nbsp;<a href="http://www.w3schools.com/tags/tag_input.asp" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: 0px 0px; background-repeat: initial; background-size: initial; box-sizing: border-box; color: #a0aabf; cursor: pointer;">input tag</a>&nbsp;attribute and does not restrict the number of characters allowed.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">You can simply double click on the ‘pattern’ attribute to edit and remove it.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-wXsIdWwDGzQ/Va8o6Gf-MuI/AAAAAAAAGMc/qhw-UBNQ_wQ/s1600/removed-attributes.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-wXsIdWwDGzQ/Va8o6Gf-MuI/AAAAAAAAGMc/qhw-UBNQ_wQ/s1600/removed-attributes.png" /></a></div><br />As for ‘Site URL’, the&nbsp;<a href="http://www.w3schools.com/tags/att_input_type.asp" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: 0px 0px; background-repeat: initial; background-size: initial; box-sizing: border-box; color: #a0aabf; cursor: pointer;">type</a>&nbsp;attribute specified is ‘URL’, which also checks our input for a URL. In Chrome, this can be easily bypassed by adding ‘:’ between our input.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-H6VZOSA3Eds/Va8o6PbZzuI/AAAAAAAAGM4/2ESVdJX7lPw/s1600/not-done.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-H6VZOSA3Eds/Va8o6PbZzuI/AAAAAAAAGM4/2ESVdJX7lPw/s1600/not-done.png" /></a></div></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">However, as seen above, we are not done yet!</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">If you click on the ‘Sources’ tab in the developer tools, you should see the JavaScript sources for this level.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-h1xSeut2GDQ/Va8o7MhSWbI/AAAAAAAAGNA/1gj7R5hGsSg/s1600/sources.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-h1xSeut2GDQ/Va8o7MhSWbI/AAAAAAAAGNA/1gj7R5hGsSg/s1600/sources.png" /></a></div></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Lines 18 and 19 are performing validation by replacing our script tags with&nbsp;<a href="http://www.w3schools.com/html/html_entities.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">HTML Entities</a>. Let’s remove the&nbsp;<a href="http://www.w3schools.com/jsref/jsref_replace.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">replace</a>&nbsp;call, then press Ctrl + s on your keyboard (on Windows) to save the changes we made, or right click and press Save (You do not have to save the file to your system).</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ZBVIgVf3gzo/Va8o6Gz3Q5I/AAAAAAAAGM0/bthAwPrIewA/s1600/remove-replace.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-ZBVIgVf3gzo/Va8o6Gz3Q5I/AAAAAAAAGM0/bthAwPrIewA/s1600/remove-replace.png" /></a></div></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Now, insert your script tags, add an alert with the message ‘Ex1’, click on Add Link and you should see an alert box with the message ‘Ex1’!</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-GKtZtwMpcdk/Va8o63Ie6hI/AAAAAAAAGM8/6_WS93vBFKs/s1600/solved.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-GKtZtwMpcdk/Va8o63Ie6hI/AAAAAAAAGM8/6_WS93vBFKs/s1600/solved.png" /></a></div><br /></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_49" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">Never rely on front-end input validation because it can be modified/controlled by a malicious user.</em></div>