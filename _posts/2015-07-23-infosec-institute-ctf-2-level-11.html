---
layout: post
title: 'InfoSec Institute CTF #2: Level 11'
date: '2015-07-23T22:37:00.001+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-23T22:37:48.754+08:00'
thumbnail: http://3.bp.blogspot.com/-tCuFv1RzMGM/VbD7DB8fOBI/AAAAAAAAGOg/nI6-GuMF68U/s72-c/ex11_intro.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-3490481265637125353
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-11.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_8" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">It appears we have been banned once entering this level. The goal for this level is for us to remove the ban. Seems simple enough.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-tCuFv1RzMGM/VbD7DB8fOBI/AAAAAAAAGOg/nI6-GuMF68U/s1600/ex11_intro.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-tCuFv1RzMGM/VbD7DB8fOBI/AAAAAAAAGOg/nI6-GuMF68U/s1600/ex11_intro.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We start by finding out how users are identified as blacklisted.</div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_15" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">For a website to blacklist specific users, there must be an identifier for every user. Without this identifier, the website would not know whether a user blacklisted or not.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">One way the website could identify me was by my&nbsp;<a href="http://www.webopedia.com/TERM/I/IP_address.html" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">IP address</a>. However, that would mean a permanent ban unless I can change my IP address, and this is not likely to be the solution.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Another means of identifying users would be through&nbsp;<a href="http://www.webopedia.com/TERM/C/cookie.html" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">cookies</a>.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Ne_1u0mot8k/VbD7D_eRkPI/AAAAAAAAGO4/wTHSOLmTtB0/s1600/welcome_cookie.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-Ne_1u0mot8k/VbD7D_eRkPI/AAAAAAAAGO4/wTHSOLmTtB0/s1600/welcome_cookie.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">A quick check shows us an interesting cookie&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">welcome=no</code>.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">This cookie could be used to determine if a user is blacklisted. We can easily bypass this ban by changing the value of the cookie to&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">welcome=yes</code>&nbsp;using any cookie manager/editor.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EO--Ny-2hiQ/VbD7DOKBF0I/AAAAAAAAGOw/lA4QppihZck/s1600/change_welcome.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-EO--Ny-2hiQ/VbD7DOKBF0I/AAAAAAAAGOw/lA4QppihZck/s1600/change_welcome.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Refresh the page and weâ€™ve passed another level!</div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-8Sp9Nrjt2Hw/VbD7_uECNnI/AAAAAAAAGO8/AZIRfigF14M/s1600/success.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-8Sp9Nrjt2Hw/VbD7_uECNnI/AAAAAAAAGO8/AZIRfigF14M/s1600/success.png" /></a></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_34" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">Storing sensitive data at the client-side is never a good idea.</em></div>