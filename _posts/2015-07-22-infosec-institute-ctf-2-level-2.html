---
layout: post
title: 'InfoSec Institute CTF #2: Level 2'
date: '2015-07-22T23:07:00.000+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-25T00:33:16.033+08:00'
thumbnail: http://1.bp.blogspot.com/-22BwQ2JEep0/Va-wEH_h4eI/AAAAAAAAGNg/9PRv4sqZ080/s72-c/ex2_intro.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-2888761045024614496
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-2.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_8" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We are tasked with ‘injecting a PHP statement that shows information about Apache and things like the PHP version’. This can be done by using the&nbsp;<a href="http://php.net/manual/en/function.phpinfo.php" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">phpinfo()</a>&nbsp;command.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-22BwQ2JEep0/Va-wEH_h4eI/AAAAAAAAGNg/9PRv4sqZ080/s1600/ex2_intro.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-22BwQ2JEep0/Va-wEH_h4eI/AAAAAAAAGNg/9PRv4sqZ080/s1600/ex2_intro.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">I’ll be using the free version of&nbsp;<a href="https://portswigger.net/burp/download.html" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">Burp Suite</a>&nbsp;to manipulate the value of parameters sent. You can use any equivalent tool or even just manipulate the DOM(using Developer Tools) to change the value submitted.</div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_15" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">By looking at the requests going through Burp, we can see that there are 3 parameters being sent to the server for processing.</div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;">opera<span class="hljs-label" style="box-sizing: border-box;">nd1</span>=<span class="hljs-number" style="box-sizing: border-box; color: #2aa198;">1</span>&amp;operator=<span class="hljs-preprocessor" style="box-sizing: border-box; color: #cb4b16;">%</span><span class="hljs-number" style="box-sizing: border-box; color: #2aa198;">2</span>B&amp;opera<span class="hljs-label" style="box-sizing: border-box;">nd2</span>=<span class="hljs-number" style="box-sizing: border-box; color: #2aa198;">2</span><br /></code></pre><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">You can also find these parameters by identifying&nbsp;<a href="http://www.w3schools.com/tags/tag_input.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">input tags</a>&nbsp;in the source of the page.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Injecting anything other than numbers in ‘operand1’ and ‘operand2’ will result in an invalid operands error.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-U1VQsfaBcUc/Va-wE-vV-HI/AAAAAAAAGNo/Lps-47mKhLU/s1600/invalid_operands.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-U1VQsfaBcUc/Va-wE-vV-HI/AAAAAAAAGNo/Lps-47mKhLU/s1600/invalid_operands.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">So we’re only left with the ‘operator’ parameter. Tampering with it gives us a different error that looks like we broke something.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-s4f5ufUjEhQ/VbJowNYaRZI/AAAAAAAAGPs/JdAX2M38yrQ/s1600/diff_error.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-s4f5ufUjEhQ/VbJowNYaRZI/AAAAAAAAGPs/JdAX2M38yrQ/s1600/diff_error.png" /></a></div></div><div class="separator" style="clear: both; text-align: center;"></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">As mentioned earlier, you can modify the value of the selected option in the operator dropdown list(<a href="http://www.w3schools.com/tags/tag_select.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">select tag</a>&nbsp;in HTML) using Developer Tools.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">You can also tamper with the operator value using Burp by intercepting the request and modifying the value.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Now, we cannot just inject ‘phpinfo()’ because the resulting statement in PHP would look something like this:</div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;"><span class="hljs-number" style="box-sizing: border-box; color: #2aa198;">1</span> <span class="hljs-function" style="box-sizing: border-box;"><span class="hljs-title" style="box-sizing: border-box; color: #268bd2;">phpinfo</span><span class="hljs-params" style="box-sizing: border-box;">()</span></span> <span class="hljs-number" style="box-sizing: border-box; color: #2aa198;">2</span><br /></code></pre><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">When the statement above is used for execution, an error would occur as it is not a valid PHP instruction.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">PHP&nbsp;<a href="http://php.net/manual/en/language.basic-syntax.instruction-separation.php" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">separates instructions</a>&nbsp;by using semicolons. We can use this to our advantage by injecting semicolons to terminate the instructions before and after our injected ‘phpinfo()’.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">I did this by injecting ‘;phpinfo();’. This should result in a PHP statement like so:</div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;"><span class="hljs-attribute" style="box-sizing: border-box; color: #b58900;">1</span> ;<span class="hljs-attribute" style="box-sizing: border-box; color: #b58900;">phpinfo</span>(); <span class="hljs-attribute" style="box-sizing: border-box; color: #b58900;">2</span><br /></code></pre><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">This is executes without any errors and this level is complete!</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-paA86r6IHMQ/Va-wEAN-QAI/AAAAAAAAGNs/cxnBw119zQ8/s1600/completed.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-paA86r6IHMQ/Va-wEAN-QAI/AAAAAAAAGNs/cxnBw119zQ8/s1600/completed.png" /></a></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"></h5><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_50" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">Never trust input originating from users!</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;"></em></div><div class="separator" style="clear: both; text-align: center;"></div>