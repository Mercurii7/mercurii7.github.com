---
layout: post
title: 'InfoSec Institute CTF #2: Level 13'
date: '2015-07-29T19:40:00.000+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-29T19:42:38.546+08:00'
thumbnail: http://2.bp.blogspot.com/-roBoj0e4Npw/Vbi6_HvrfwI/AAAAAAAAGWI/_pMkg6EcsFE/s72-c/ex13_intro.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-3668245546040232222
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-13.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_8" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We are being redirected as we try to access level 13.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-roBoj0e4Npw/Vbi6_HvrfwI/AAAAAAAAGWI/_pMkg6EcsFE/s1600/ex13_intro.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-roBoj0e4Npw/Vbi6_HvrfwI/AAAAAAAAGWI/_pMkg6EcsFE/s1600/ex13_intro.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We want to analyze and validate the redirection to redirect users to a page on a remote server.</div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_15" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Let’s start by getting the URL for level 13 before redirection. We can either view the source of the page, or just copy the link to level 13 from the&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">Levels</code>menu on the top left of the page.</div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;"><span class="hljs-tag" style="box-sizing: border-box;">&lt;<span class="hljs-title" style="box-sizing: border-box; color: #268bd2;">li</span>&gt;</span><span class="hljs-tag" style="box-sizing: border-box;">&lt;<span class="hljs-title" style="box-sizing: border-box; color: #268bd2;">a</span> <span class="hljs-attribute" style="box-sizing: border-box; color: #b58900;">class</span>=<span class="hljs-value" style="box-sizing: border-box; color: #2aa198;">"exPending"</span> <span class="hljs-attribute" style="box-sizing: border-box; color: #b58900;">href</span>=<span class="hljs-value" style="box-sizing: border-box; color: #2aa198;">"../exercises/ex13.php?redirect=ex13-task.php"</span>&gt;</span>Level 13<span class="hljs-tag" style="box-sizing: border-box;">&lt;/<span class="hljs-title" style="box-sizing: border-box; color: #268bd2;">a</span>&gt;</span><span class="hljs-tag" style="box-sizing: border-box;">&lt;/<span class="hljs-title" style="box-sizing: border-box; color: #268bd2;">li</span>&gt;</span><br /></code></pre><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">The full URL for level 13:&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">http://ctf.infosecinstitute.com/ctf2/exercises/ex13.php?redirect=ex13-task.php</code></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Our target should be to manipulate the&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect</code>&nbsp;parameter, to test if it will redirect us to a remote website. We can start by changing the value of redirect to a remote website, e.g.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect=http://www.example.com</code></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-XMNNPC_j6As/Vbi6_P3-LFI/AAAAAAAAGWc/bAHcj4nIxas/s1600/bad_redirect_parameter.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-XMNNPC_j6As/Vbi6_P3-LFI/AAAAAAAAGWc/bAHcj4nIxas/s1600/bad_redirect_parameter.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">And we get an error. Let’s test if they check for case sensitivity.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect=hTtP://wWw.ExAmPlE.cOm</code></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Still the same error. What if we try without&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">http://</code></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect=www.example.com</code></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Still faced with the same error… Without&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">www</code>?</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect=http://example.com</code></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">The same error again. Finally, without both&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">http://</code>&nbsp;and&nbsp;<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">www</code>.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">redirect=example.com</code></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-cUovdztj_TU/Vbi6_C26KtI/AAAAAAAAGWU/4fnJRX87KwI/s1600/404.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-cUovdztj_TU/Vbi6_C26KtI/AAAAAAAAGWU/4fnJRX87KwI/s1600/404.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><span style="background-color: white; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">This works, but we are not redirected to a remote website because we are missing both&nbsp;</span><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 14px; line-height: 28px; padding: 2px 4px;">http://</code><span style="background-color: white; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">&nbsp;and&nbsp;</span><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 14px; line-height: 28px; padding: 2px 4px;">www</code><span style="background-color: white; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">. Doing a quick google search for&nbsp;</span><a href="http://stackoverflow.com/questions/9161769/url-without-httphttps" style="background: 0px 0px rgb(255, 255, 255); box-sizing: border-box; color: #a0aabf; cursor: pointer; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">URL without http</a><span style="background-color: white; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">&nbsp;showed me that I could do&nbsp;</span><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 14px; line-height: 28px; padding: 2px 4px;">//www.example.com</code><span style="background-color: white; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px;">&nbsp;and the URL would still work.</span></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-VFakL2fG-EE/Vbi6_nziXTI/AAAAAAAAGWg/649nCzlCRmo/s1600/success.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-VFakL2fG-EE/Vbi6_nziXTI/AAAAAAAAGWg/649nCzlCRmo/s1600/success.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">And success! We’ve completed level 13.</div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_56" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">Always validate the user supplied value of redirects. If possible, simply avoid using them all together!</em></div>