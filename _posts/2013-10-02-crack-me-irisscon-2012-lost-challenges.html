---
layout: post
title: Crack Me! - IRISSCON 2012 Lost Challenges
date: '2013-10-02T01:17:00.001+08:00'
author: KE
tags:
- IRISSCON 2012 Lost Challenges
- WeChall
modified_time: '2013-10-04T21:09:17.894+08:00'
thumbnail: http://2.bp.blogspot.com/-ZE1lMiiaHGg/Ukr45nNlQ5I/AAAAAAAAA5E/my2TUZfo50M/s72-c/errorLocation.JPG
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-1851493054317983505
blogger_orig_url: http://kectf.blogspot.com/2013/10/crack-me-irisscon-2012-lost-challenges.html
---

After having participated in CSAW CTF Qualification Round 2013, I had some free time so I've decided to try to solve some existing challenges. These few posts will be write ups/tutorials for challenges that I manage to solve for&nbsp;<a href="http://damienoreilly.org/ctf" target="_blank">IRISSCON 2012 Lost Challenges</a>. There are 13 challenges total, so hopefully there will be 13 write ups!<br /><br />Crack Me! - Easy - 300<br /><br />Extracting the zip archive gives&nbsp;irisscon-crackme.exe. Executing it just gives "Please insert the IRISSCON 2012 CD-ROM". So, this challenge is about bypassing the check that gives that error. There are 2 ways to solve this challenge:<br /><br /><ul><li>Patch the executable using a hex editor to bypass the check</li><li>Use a debugger to change the value the&nbsp;executable&nbsp;checks</li></ul><div><u>Analysing the application</u></div><div>To bypass the check, we first need to analyse the&nbsp;executable&nbsp;and find out how it checks if the CD-ROM is inserted. I'll use IDA to disassemble it.&nbsp;</div><div><br /></div><div>Start by looking at the Strings window (Views-&gt;Open Subviews-&gt;Strings / Shift + F12) and find the error message. Double click it.</div><br /><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-ZE1lMiiaHGg/Ukr45nNlQ5I/AAAAAAAAA5E/my2TUZfo50M/s1600/errorLocation.JPG" imageanchor="1"><img alt="Error Message Location" border="0" height="28" src="http://2.bp.blogspot.com/-ZE1lMiiaHGg/Ukr45nNlQ5I/AAAAAAAAA5E/my2TUZfo50M/s1600/errorLocation.JPG" title="" width="560" /></a></div><br />IDA will show us which function used the string with XREF, so just double click on the function to get there.<br /><br />sub_401358:<br />This function seems to be responsible for printing the error message, not exactly what we are interested in. The assembly functions we really want to look at are calls, jumps or compares. The only calls in this function are to MessageBoxA and exit. So we'll look at the xref of this function and go to it.<br /><br />sub_4014EC:<br /><blockquote class="tr_bq"><code>.text:00401501                 jz      short loc_401514</code><code>.text:00401503                 call    sub_401358</code></blockquote>Looking at this part of function, we can see that before the call to print the error message, there is a jump to loc_401514. This is interesting because if we jump to that location, the error message will not be printed we should executable should proceed as if the CD-ROM is inserted.<br /><br /><u>Patching the executable</u><br />Great! So now all we need to do is flip jz to jnz which will cause the executable to jump to that location. I've decided to use a hex editor to change the hex values of the executable which will then reflect a change in the assembly instruction. After some googling, I found a website that shows all the hex values of assembly instructions. JZ is 74 and JNZ is 75.<br /><br />Clicking on the jz line in IDA and switching to the hex view will show the hex values at that location in the executable. With that, just open up a hex editor and go to that location or search for it and change 74 to 75, save it and we are done. Executing it after patching now displays the main window with the key!<br /><br /><u>Using a debugger</u><br />Just open the executable in your favourite debugger and set a breakpoint at the jump address found in IDA. Toggle the value of ZF and continue running the executable. You should be able to get to the main window with the key!<br /><br />I've decided not to post the actual key so that people will actually have to learn to do this on their own if they want the key.<br /><br /><br /><b>Links and Other Stuff</b><br /><a href="http://ref.x86asm.net/coder32.html" target="_blank">x86 Opcode and Instruction</a><br /><a href="https://www.hex-rays.com/products/ida/support/download.shtml" target="_blank">IDA</a><br /><br /><br />