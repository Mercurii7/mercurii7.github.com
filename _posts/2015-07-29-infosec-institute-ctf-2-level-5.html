---
layout: post
title: 'InfoSec Institute CTF #2: Level 5'
date: '2015-07-29T16:57:00.000+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-29T16:57:10.546+08:00'
thumbnail: http://3.bp.blogspot.com/-mIt0oC0NeJ8/VbiU6lEI8UI/AAAAAAAAGVQ/PoBARyUt8Yw/s72-c/ex5_intro.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-5605649207045381500
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-5.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_8" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We encounter a page that requires us to login before we can view it. For this level, our task is to bypass logging in.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-mIt0oC0NeJ8/VbiU6lEI8UI/AAAAAAAAGVQ/PoBARyUt8Yw/s1600/ex5_intro.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="179" src="http://3.bp.blogspot.com/-mIt0oC0NeJ8/VbiU6lEI8UI/AAAAAAAAGVQ/PoBARyUt8Yw/s320/ex5_intro.png" width="320" /></a></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_13" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We start by learning how the web application works. There is a disabled login button, but inspecting it with developer tools or viewing the source will show us the login URL. Browsing to the login URL just gave us a 404 page not found error.</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-zfOWkl15Wkk/VbiU63obBtI/AAAAAAAAGVI/NNBdkxMlc9A/s1600/404.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-zfOWkl15Wkk/VbiU63obBtI/AAAAAAAAGVI/NNBdkxMlc9A/s1600/404.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">http://ctf.infosecinstitute.com/ctf2/exercises/login.html</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"></div><br /><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Looking at the hints, we can see that we are supposed to modify the HTTP Referer header and imitate that the login page is sending us to this level. The<code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">Referer</code>&nbsp;header is normally used by a webpage to see where the request(for the webpage) came from.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">In this case, it seems the Referer header is used for authentication, which is a bad idea as it can be easily modified. The webpage will check the Referer and if the Referer points to the login page(<a href="http://ctf.infosecinstitute.com/ctf2/exercises/login.html" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">http://ctf.infosecinstitute.com/ctf2/exercises/login.html</a>), the webpage will assume the user is authenticated.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We can easily modify the Referer header by using any intercepting proxy such as the free version of&nbsp;<a href="https://portswigger.net/burp/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">Burp</a>. Just add in the Referer header with the login page as the its value:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-1fQ3jV7pYQQ/VbiU6_xdZ1I/AAAAAAAAGVU/Ma1XA8bKz_U/s1600/referer.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-1fQ3jV7pYQQ/VbiU6_xdZ1I/AAAAAAAAGVU/Ma1XA8bKz_U/s1600/referer.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Submit the modified request, and we've completed this level!</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-E9rqGStPxAw/VbiU7fG1Y8I/AAAAAAAAGVY/T85hT9G4Yyw/s1600/success.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-E9rqGStPxAw/VbiU7fG1Y8I/AAAAAAAAGVY/T85hT9G4Yyw/s1600/success.png" /></a></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_31" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">The Referer header should not be used for authentication or authorization as it can be easily modified.</em></div>