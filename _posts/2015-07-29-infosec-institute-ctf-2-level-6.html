---
layout: post
title: 'InfoSec Institute CTF #2: Level 6'
date: '2015-07-29T18:28:00.003+08:00'
author: KE
tags:
- InfoSecInstitute CTF#2
modified_time: '2015-07-29T18:28:51.414+08:00'
thumbnail: http://4.bp.blogspot.com/-juQJl0Ulvr4/VbiqiTIbhlI/AAAAAAAAGVo/0A-FV-mj9_Q/s72-c/ex6_intro.png
blogger_id: tag:blogger.com,1999:blog-2905258938461604888.post-6169013284373514690
blogger_orig_url: http://kectf.blogspot.com/2015/07/infosec-institute-ctf-2-level-6.html
---

<div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">In the second edition of n00bs CTF Labs, there are 13 small challenges to test your web app hacking skills. The challenges are based on common vulnerabilities (XXS, code injection, inadequate redirect functions etc.) as well as older and less frequently seen vulnerabilities such as Data Validation; Parameter Delimiter.</em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">You can access the CTF by&nbsp;<a href="http://ctf.infosecinstitute.com/ctf2/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CLICKING HERE</a></em></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">This post includes a full walkthrough of how I solved the challenges. If you wish to avoid spoilers, you might want to attempt the challenges yourself before reading on ;).</em></div><hr style="background-color: white; box-sizing: content-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; height: 0px; line-height: 28px;" /><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="BEGIN_8" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>BEGIN</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">We have a page that accepts some HTML tags for article comments.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-juQJl0Ulvr4/VbiqiTIbhlI/AAAAAAAAGVo/0A-FV-mj9_Q/s1600/ex6_intro.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-juQJl0Ulvr4/VbiqiTIbhlI/AAAAAAAAGVo/0A-FV-mj9_Q/s1600/ex6_intro.png" /></a></div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Assuming these comments are viewable by other users publicly, we are to exploit this and force users to perform an action by have them send a request to&nbsp;<a href="http://www.site.com/bank.php" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">http://www.site.com/bank.php</a>&nbsp;with the&nbsp;<a href="https://en.wikipedia.org/wiki/Query_string" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">query string</a>&nbsp;of transferTo=555.</div><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><code style="background-color: #f9f2f4; border-radius: 4px; box-sizing: border-box; color: #c7254e; font-family: monospace, monospace; font-size: 1em; padding: 2px 4px;">http://www.site.com/bank.php?transferTo=555</code></div><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="Walkthrough_17" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>Walkthrough</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">Taking a look at the accepted HTML tags, the only ones that allow us to insert a URL that would force users to make a request to a remote site are:&nbsp;<a href="http://www.w3schools.com/tags/tag_a.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">a</a>&nbsp;and&nbsp;<a href="http://www.w3schools.com/tags/tag_img.asp" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">img</a>. However, inserting the URL into the &lt;a&gt; tag would require the user to click on it for the request to be made.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-d3DiZqtPEjE/VbiqiQjBumI/AAAAAAAAGVw/eATwOz5wzyc/s1600/better_way.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-d3DiZqtPEjE/VbiqiQjBumI/AAAAAAAAGVw/eATwOz5wzyc/s1600/better_way.png" /></a></div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;"><span class="hljs-variable" style="box-sizing: border-box; color: #b58900;">&lt;a href="http:/www.site.com/bank.php?transferTo=555&gt;</span>Click Me<span class="hljs-variable" style="box-sizing: border-box; color: #b58900;">&lt;/a&gt;</span><br /></code></pre><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;">If we insert the URL into the &lt;img&gt; tag, the browser will try to load the image each time the page is visited, and automatically submit the request to&nbsp;<a href="http://www.site.com/" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">www.site.com</a>. This is a much better method as it removes the need for user interaction.</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qkkPk8KeCm0/VbiqiY-fVzI/AAAAAAAAGV4/-HzyywRTZL8/s1600/success.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-qkkPk8KeCm0/VbiqiY-fVzI/AAAAAAAAGV4/-HzyywRTZL8/s1600/success.png" /></a></div><pre style="background: linear-gradient(rgb(255, 255, 255) 0px, rgb(255, 255, 255) 0.75rem, rgb(245, 247, 250) 0.75rem, rgb(245, 247, 250) 2.75rem, rgb(255, 255, 255) 2.75rem, rgb(255, 255, 255) 4rem) rgb(255, 255, 255); border-radius: 4px; border: 1px solid rgb(211, 218, 234); box-sizing: border-box; color: #333333; font-family: monospace, monospace; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; overflow: auto; padding: 0.66001rem 9.5px 9.5px; word-break: break-all; word-wrap: break-word;"><code style="background-color: transparent; border-radius: 0px; box-sizing: border-box; color: inherit; font-family: monospace, monospace; font-size: inherit; padding: 0px; white-space: pre-wrap;">&lt;<span class="hljs-tag" style="box-sizing: border-box;">img</span> src=<span class="hljs-string" style="box-sizing: border-box; color: #2aa198;">"http://www.site.com/bank.php?transferTo=555"</span>&gt;<br /></code></pre><h5 style="-webkit-font-feature-settings: 'dlig' 1, 'liga' 1, 'lnum' 1, 'kern' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: 'Source Sans Pro', 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 1.25rem; line-height: 28px; margin-bottom: -0.56251rem; margin-top: 0px; padding-top: 0.56251rem;"><a href="https://www.blogger.com/null" id="END_32" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer; text-decoration: underline;"></a>END</h5><div style="-webkit-font-feature-settings: 'kern' 1, 'onum' 1, 'liga' 1; background-color: white; box-sizing: border-box; color: #373d49; font-family: Georgia, Cambria, serif; font-size: 14px; line-height: 28px; margin-bottom: 1.33999rem; padding-top: 0.66001rem;"><em style="box-sizing: border-box;">Build&nbsp;<a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)" style="background: 0px 0px; box-sizing: border-box; color: #a0aabf; cursor: pointer;">CSRF</a>&nbsp;protection into your websites as there are many other websites that allow users to do what we just did.</em></div>